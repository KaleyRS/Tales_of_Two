#textdomain wesnoth-tales_of_two

#define TOT_ITEM_STANDARD_EXCLUDE
    side=1,2
    [not]
        id=Kaley,Nour,Venerion,Owen,Gok,Saurian4
    [/not]
#enddef

#define TOT_ITEM_IS_GEARED
    [effect]
        apply_to=overlay
        add=misc/geared.png
    [/effect]
    [effect]
        apply_to=new_ability
        [abilities]
            {TOT_ABILITIES_GEARED}
        [/abilities]
    [/effect]
#enddef

#define STYLE_ITEM COLOUR SIZE TEXT
<span color='{COLOUR}' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef

#define STYLE_ITEM_COMMON SIZE TEXT
<span color='#14D000' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef
#define STYLE_ITEM_RARE SIZE TEXT
<span color='#003FE8' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef
#define STYLE_ITEM_EPIC SIZE TEXT
<span color='#6B009A' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef
#define STYLE_ITEM_LEGENDARY SIZE TEXT
<span color='#FF6D00' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef

#define STYLE_ITEM_STATS_DAMAGE TEXT
<span color='#D7A300' size='medium'>Damage increased by {TEXT}</span>#enddef
#define STYLE_ITEM_STATS_ATTACKS TEXT
<span color='#D7A300' size='medium'>Attacks increased by {TEXT}</span>#enddef
#define STYLE_ITEM_STATS_CUSTOM TEXT
<span color='#D7A300' size='medium'>{TEXT}</span>#enddef
#define STYLE_ITEM_SPECIAL TEXT
<span color='#00DDEC' size='medium' font-style='italic'>New weapon special: {TEXT}</span>#enddef
#define STYLE_ITEM_STATS_TYPE TEXT
<span color='#9FB6CA' size='medium' font-style='italic'>Type: {TEXT}</span>#enddef
#define STYLE_ITEM_DESCRIPTION SIZE TEXT
<span color='#9FB6CA' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef

# This is to ensure you cannot stack weapons

# #define TOT_ITEM_TYPE_CHECK TYPE
#     [foreach]
#         array=itemList.{TYPE}
#         [do]
#             [not]
#                 [has_attack]
#                     formula="contains_string(description, 'this_item' )"
#                 [/has_attack]
#             [/not]
#         [/do]
#     [/foreach]
# #enddef

#define TOT_ITEM_TYPE_SPEAR_CHECK
    [not]
        [has_attack]
            formula="contains_string(description, 'old warspear' )"
        [/has_attack]
    [/not]
#enddef

#define TOT_ITEM_TYPE_HAMMER_CHECK
    [not]
        [has_attack]
            formula="contains_string(description, 'Lightning Hammer' )"
        [/has_attack]
    [/not]
#enddef

#define TOT_ITEM_TYPE_BOW_CHECK
    [not]
        [has_attack]
            formula="contains_string(description, 'crystal longbow' )"
        [/has_attack]
    [/not]
    [not]
        [has_attack]
            formula="contains_string(description, 'crystal shortbow' )"
        [/has_attack]
    [/not]
#enddef

#define TOT_ITEM_TYPE_SWORD_CHECK
    [not]
        [has_attack]
            formula="contains_string(description, 'elvish longsword' )"
        [/has_attack]
    [/not]
    [not]
        [has_attack]
            formula="contains_string(description, 'handcrafted shortsword' )"
        [/has_attack]
    [/not]
    [not]
        [has_attack]
            formula="contains_string(description, 'handcrafted longsword' )"
        [/has_attack]
    [/not]
#enddef

#define TOT_ITEM_TYPE_STAFF_CHECK
        [not]
            [has_attack]
                formula="contains_string(description, 'infernal battlestaff' )"
            [/has_attack]
        [/not]
        [not]
            [has_attack]
                formula="contains_string(description, 'blue staff' )"
            [/has_attack]
        [/not]
#enddef

    #####################
  ##     Weapons     ##
#####################

#define TOT_ITEM_ENCHANTED_ELVISH_BOOK X Y ID
    {TOT_ITEM_2 "empowered faerie fire" () "rare" "attacks/empowered_faerie_fire.png" {ID} {X} {Y} (
        race=human,elf
        {TOT_ITEM_STANDARD_EXCLUDE}
        [not]
            [has_attack]
                name=$item{ID}.name
            [/has_attack]
        [/not]
    ) ("items/book4.png")
    (_"$unit.name finds a book that contains the powers to learn $item{ID}.name, an arcane based spell. Read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) (Enchanted Elvish Book) }
    {STYLE_ITEM_STATS_DAMAGE (29)}
    {STYLE_ITEM_STATS_ATTACKS (2)}
    {STYLE_ITEM_SPECIAL (magical, firststrike)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You learn the spell!"
            [effect]
                apply_to=new_attack
                name=$item{ID}.name
                description= {STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }
                icon=$item{ID}.icon
                type=arcane
                range=ranged
                [set_specials]
                    {WEAPON_SPECIAL_MAGICAL}
                    {WEAPON_SPECIAL_FIRSTSTRIKE}
                [/set_specials]
                damage=29
                number=2
                start_time=-450
            [/effect]
            [effect]
                apply_to=new_animation
                id=$item{ID}.name
                [attack_anim]
                    [filter_attack]
                        name=$item{ID}.name
                    [/filter_attack]
                    {MISSILE_FRAME_FAERIE_FIRE}
                    {SOUND:HIT_AND_MISS magic-faeriefire.ogg magic-faeriefire-miss.ogg -450}
                [/attack_anim]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_OLD_WARSPEAR X Y ID
    {TOT_ITEM_2 "old warspear" "spear" "epic" "attacks/spear-blue.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SPEAR_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/spear-blue.png")
    (_"$unit.name finds an $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (30%)}
    {STYLE_ITEM_STATS_ATTACKS (1)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (pierce)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                remove_specials=marksman
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=30%
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_CRYSTAL_LONGBOW X Y ID
    {TOT_ITEM_2 "crystal longbow" "bow" "epic" "attacks/crystal_bow.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_BOW_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/crystal-longbow.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (11)}
    {STYLE_ITEM_STATS_ATTACKS (-2)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
                remove_specials=marksman
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=11
                increase_attacks=-2
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_CRYSTAL_SHORTBOW X Y ID
    {TOT_ITEM_2 "old warspear" "bow" "epic" "attacks/spear-blue.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_BOW_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/bow-crystal.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (-20%)}
    {STYLE_ITEM_STATS_ATTACKS (3)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
                remove_specials=marksman
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=-20%
                increase_attacks=3
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_ELVISH_LONGSWORD X Y ID
    {TOT_ITEM_2 "elvish longsword" "sword" "epic" "attacks/sword-elven-enchanted.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/elvish-longsword.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (5)}
    {STYLE_ITEM_STATS_ATTACKS (2)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=5
                increase_attacks=2
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_HUMAN_SHORTSWORD X Y ID
    {TOT_ITEM_2 "handcrafted shortsword" "sword" "epic" "attacks/sword-human.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/human-shortsword.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (-20%)}
    {STYLE_ITEM_STATS_ATTACKS (3)}
    {STYLE_ITEM_STATS_TYPE (blade)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=blade
                increase_damage=-20%
                increase_attacks=3
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_HUMAN_LONGSWORD X Y ID
    {TOT_ITEM_2 "handcrafted longsword" "sword" "epic" "attacks/sword-human.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/human-longsword.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (66%)}
    {STYLE_ITEM_STATS_ATTACKS (-33%)}
    {STYLE_ITEM_STATS_TYPE (blade)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=blade
                increase_damage=66%
                increase_attacks=-33%
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_STAFF_BLUE X Y ID
    {TOT_ITEM_2 "blue staff" "staff" "rare" "attacks/staff-elven.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-blue.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (All magical damage increased by 25%)}
    {STYLE_ITEM_STATS_CUSTOM (All magical attacks increased by 1)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (cold)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=25%
                set_type=cold
            [/effect]
            [effect]
                apply_to=attack
                type=fire,cold,arcane
                increase_damage=25%
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_STAFF_INFERNAL X Y ID
    {TOT_ITEM_2 "infernal battlestaff" "staff" "epic" "attacks/staff-magic3.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-red.png")
    (_"$unit.name finds a $item{ID}.name brimming with fiery power. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Fire damage increased by 70%)}
    {STYLE_ITEM_STATS_CUSTOM (Fire attacks increased by -2)}
    {STYLE_ITEM_STATS_CUSTOM (Melee attacks set to 1)}
    {STYLE_ITEM_SPECIAL (magical, overwhelming)}
    {STYLE_ITEM_STATS_TYPE (fire)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=70%
                increase_attacks=-100%
                increase_attacks=1
                set_type=fire
            [/effect]
            [effect]
                apply_to=attack
                type=fire
                increase_damage=70%
                increase_attacks=-2
                remove_specials=overwhelming tot
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_OVERWHELMING}
                [/set_specials]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_HAMMER_LIGHTNING X Y ID
    {TOT_ITEM_2 "lightning hammer" "hammer" "legendary" "attacks/hammer-runic2.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_HAMMER_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/hammer-runic-lightning.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (9)}
    {STYLE_ITEM_STATS_CUSTOM (Learn arcane lightning, arcane smash)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (impact, arcane, arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=impact
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=9
            [/effect]

            [effect]
                apply_to=new_attack
                name= $item{ID}.types_apply
                description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) (arcane smash) }"
                icon=$item{ID}.icon
                type=arcane
                range=melee
                [set_specials]
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                damage=29
                number=1
            [/effect]
            
            [effect]
                apply_to=new_attack
                name="lightning"
                description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) (otherworldly lightning) }"
                icon=attacks/lightning.png
                type=arcane
                range=ranged
                [set_specials]
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                damage=17
                number=3
            [/effect]
            {LIGHTNING_ANIMATION "lightning" 1}
            {LIGHTNING_ANIMATION "lightning" 2}
            {LIGHTNING_ANIMATION "lightning" 3}
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

    #####################
  ##    Jewellery    ##
#####################

#define TOT_ITEM_AMULET_OF_STRENGTH X Y ID
    {TOT_ITEM_2 "amulet of strength" () "common" "items/amulet_strength.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/amulet_strength.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Melee damage increased by 7)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                range=melee
                increase_damage=7
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_BALANCE X Y ID
    {TOT_ITEM_2 "amulet of balance" () "common" "items/amulet_balance.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/amulet_balance.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (All damage increased by 4)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                range=melee
                increase_damage=4
            [/effect]
            [effect]
                apply_to=attack
                range=ranged
                increase_damage=4
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_HASTE X Y ID
    {TOT_ITEM_2 "amulet of haste" () "common" "items/amulet_haste.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/amulet_haste.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Melee attacks increased by 2)}
    {STYLE_ITEM_STATS_CUSTOM (Ranged pierce attacks increased by 1)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                range=melee
                increase_attacks=2
            [/effect]
            [effect]
                apply_to=attack
                range=ranged
                type=pierce
                increase_attacks=1
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_MAGIC X Y ID
    {TOT_ITEM_2 "amulet of magic" () "common" "items/amulet_magic.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/amulet_magic.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magic damage increased by 3)}
    {STYLE_ITEM_STATS_CUSTOM (Magic attacks increased by 1)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=attack
                type=fire,cold,arcane
                increase_damage=3
                increase_attacks=1
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_DEFENCE X Y ID
    {TOT_ITEM_2 "amulet of defence" () "rare" "items/amulet_defence.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/amulet_defence.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Physical resistances increased by 7%)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    blade=-7
                    impact=-7
                    pierce=-7
                [/resistance]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_ARCANE_FORTITUDE X Y ID
    {TOT_ITEM_2 "amulet of arcane fortitude" () "rare" "items/amulet_fortitude.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/amulet_fortitude.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magical resistances increased by 7%)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    fire=-7
                    cold=-7
                    arcane=-7
                [/resistance]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_RING_OF_REGENERATION_LESSER X Y ID
    {TOT_ITEM_2 "ring of lesser regeneration" () "common" "items/ring-regen_lesser.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/ring-regen_lesser.png")
    (_"$unit.name finds a $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Learn lesser regeneration)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_REGENERATION_LESSER}
                [/abilities]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_RING_OF_REGENERATION X Y ID
    {TOT_ITEM_2 "ring of regeneration" () "rare" "items/ring-regen_major.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/ring-regen_major.png")
    (_"$unit.name finds a $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Learn regenerates)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You equip the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_REGENERATES}
                [/abilities]
            [/effect]
        [/object]
    )}
#enddef

    #####################
  ## Potions / Books ##
#####################

#define TOT_ITEM_POTION_DARKNESS X Y ID
     {TOT_ITEM_2 "potion of darkness" () "rare" "items/potion-darkness.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-darkness.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Sets alignment to chaotic and learns dark aura)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You drink the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_DARK_AURA}
                [/abilities]
            [/effect]
            [effect]
                apply_to=remove_ability
                [abilities]
                    {ABILITY_ILLUMINATES}
                [/abilities]
            [/effect]
            [effect]
                apply_to=halo
                halo=halo/darkens-aura.png
            [/effect]
            [effect]
                apply_to=alignment
                set=chaotic
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_ILLUMINATING X Y ID
    {TOT_ITEM_2 "potion of illumination" () "rare" "items/potion-illuminating.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-illuminating.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Sets alignment to lawful and learns illuminates)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You drink the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_ILLUMINATES}
                [/abilities]
            [/effect]
            [effect]
                apply_to=remove_ability
                [abilities]
                    {TOT_ABILITIES_DARK_AURA}
                [/abilities]
            [/effect]
            [effect]
                apply_to=halo
                halo=halo/illuminates-aura.png
            [/effect]
            [effect]
                apply_to=alignment
                set=lawful
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_FOUL_LIQUID X Y ID
    {TOT_ITEM_2 "mysterious liquid" () "epic" "items/potion-foul-liquid.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-foul-liquid.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Take heavy damage temporarily but increases all stats by a large amount permanently:)}
    {STYLE_ITEM_STATS_CUSTOM (All damage increased by 25%)}
    {STYLE_ITEM_STATS_CUSTOM (All attacks increased by 15%)}
    {STYLE_ITEM_STATS_CUSTOM (All resistances increased by 5%)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You temporarily collapse as drink the $item{ID}.name.."
            [effect]
                apply_to=hitpoints
                increase=-99%
            [/effect]
            [effect]
                apply_to=attack
                range=melee
                increase_attacks=25%
                increase_damage=15%
            [/effect]
            [effect]
                apply_to=attack
                range=ranged
                increase_attacks=25%
                increase_damage=15%
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    blade=-5
                    impact=-5
                    pierce=-5
                    fire=-5
                    arcane=-5
                    cold=-5
                [/resistance]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_VITALITY X Y ID
    {TOT_ITEM_2 "potion of vitality" () "common" "items/potion-red.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-red.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Heal to full and increase maximum HP by 10)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You drink the $item{ID}.name"
            [effect]
                apply_to=hitpoints
                increase_total=10
                heal_full=yes
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_LONG_WINTER X Y ID
    {TOT_ITEM_2 "potion of the long winter" () "epic" "items/potion-of-the-long-winter.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-of-the-long-winter.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Choose to turn all your melee or ranged attacks into cold)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
    [message]
        message= _ "What attack(s) would you like to make cold?"
        speaker=narrator
        [option]
            message= _ "Make my melee attacks cold"
            [command]
                [object]
                    name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
                    image=items/potion-of-the-long-winter.png
                    duration=forever
                    description= _ "You feel a cold rush with a temporary brain freeze.."
                    [effect]
                        apply_to=hitpoints
                        increase=-25%
                    [/effect]
                    [effect]
                        apply_to=attack
                        range=melee
                        set_type=cold
                        increase_damage=4
                    [/effect]
                [/object]
            [/command]
        [/option]
        [option]
            message= _ "Make my ranged attacks cold"
            [command]
                [object]
                    name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
                    image=items/potion-of-the-long-winter.png
                    duration=forever
                    description= _ "You feel a cold rush with a temporary brain freeze.."
                    [effect]
                        apply_to=hitpoints
                        increase=-25%
                    [/effect]
                    [effect]
                        apply_to=attack
                        range=ranged
                        set_type=cold
                        increase_damage=4
                    [/effect]
                [/object]
            [/command]
        [/option]
        [option]
            message= _ "Quickly spit out the liquid (discard and lose the item)"
        [/option]
    [/message]
    )}
#enddef

#define TOT_ITEM_BOOK_ARCANE X Y ID
    {TOT_ITEM_2 "book of arcane knowledge" () "epic" "items/enchanted-book-cyan.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/enchanted-book-cyan.png")
    (_"$unit.name finds a $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Arcane damage increased by 9)}")
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You carefully read the tome as it disappears with a flash of light.."
            [effect]
                apply_to=attack
                type=arcane
                increase_damage=9
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_BOOK_COLD X Y ID
    {TOT_ITEM_2 "book of hungering darkness" () "epic" "items/enchanted-book-purple.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/enchanted-book-purple.png")
    (_"$unit.name finds a $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Cold damage increased by 4)}
    {STYLE_ITEM_SPECIAL (drains)}")
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You carefully read the tome as it falls into the void.."
            [effect]
                apply_to=attack
                type=cold
                remove_specials=drains
                [set_specials]
                    {WEAPON_SPECIAL_DRAIN}
                [/set_specials]
                increase_damage=4
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_BOOK_FIRE X Y ID
    {TOT_ITEM_2 "Tome of the phoenix" () "epic" "items/enchanted-book-red.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/enchanted-book-red.png")
    (_"$unit.name finds a $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Fire damage increased by 35%)}" )
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "You carefully read the tome as it spontaneously combusts! Ow!"
            [effect]
                apply_to=attack
                type=fire
                increase_damage=9
            [/effect]
            [effect]
                apply_to=hitpoints
                increase=-25%
            [/effect]
        [/object]
    )}
#enddef

    #####################
  ##       Misc      ##
#####################

#define TOT_ITEM_GOLD X Y AMOUNT
    [item]
        x,y={X},{Y}
        image=items/gold-coins-small.png
    [/item]

    [event]
        name=moveto
        [filter]
            x,y={X},{Y}
            side=1,2
        [/filter]
        {TOT_GOLD {AMOUNT} ("You gain " + {AMOUNT} + _ " gold each.")}
        [remove_item]
            x,y={X},{Y}
        [/remove_item]
    [/event]
#enddef

#define TOT_ITEM_GOLD_CHEST X Y AMOUNT
    [item]
        x,y={X},{Y}
        image=items/chest.png
    [/item]

    [event]
        name=moveto
        [filter]
            x,y={X},{Y}
            side=1,2
        [/filter]
        {TOT_GOLD {AMOUNT} ("You gain " + {AMOUNT} + _ " gold each.")}
        [remove_item]
            x,y={X},{Y}
        [/remove_item]
        [item]
            x,y={X},{Y}
            image=items/chest-open.png
        [/item]
    [/event]
#enddef